<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VaxSafe AI Ultimate 3.0</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--safe:#00ffcc;
--danger:#ff3b3b;
--glass:rgba(255,255,255,0.08);
}

body{
margin:0;
font-family:'Segoe UI',sans-serif;
background:linear-gradient(-45deg,#0f2027,#203a43,#2c5364,#000000);
background-size:400% 400%;
animation:gradientMove 10s ease infinite;
color:white;
text-align:center;
transition:0.5s;
}

@keyframes gradientMove{
0%{background-position:0% 50%;}
50%{background-position:100% 50%;}
100%{background-position:0% 50%;}
}

.light{
background:#f4f4f4;
color:#111;
}

h1{
margin-top:20px;
font-size:2.4rem;
background:linear-gradient(90deg,#00f5ff,#00ff99);
-webkit-background-clip:text;
color:transparent;
}

.toggle{
position:absolute;
right:20px;
top:20px;
cursor:pointer;
padding:8px 15px;
border-radius:20px;
background:var(--glass);
backdrop-filter:blur(10px);
}

.scene{
width:220px;
height:220px;
margin:40px auto;
perspective:900px;
}

.box{
width:160px;
height:160px;
position:relative;
transform-style:preserve-3d;
animation:rotate 8s linear infinite;
}

.face{
position:absolute;
width:160px;
height:160px;
background:linear-gradient(145deg,var(--safe),#00ff99);
border:2px solid rgba(255,255,255,0.2);
box-shadow:0 0 20px var(--safe);
}

.front{transform:translateZ(80px);}
.back{transform:rotateY(180deg) translateZ(80px);}
.right{transform:rotateY(90deg) translateZ(80px);}
.left{transform:rotateY(-90deg) translateZ(80px);}
.top{transform:rotateX(90deg) translateZ(80px);}
.bottom{transform:rotateX(-90deg) translateZ(80px);}

@keyframes rotate{
from{transform:rotateX(-20deg) rotateY(0deg);}
to{transform:rotateX(-20deg) rotateY(360deg);}
}

.dashboard{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:20px;
margin-top:20px;
}

.card{
background:var(--glass);
backdrop-filter:blur(12px);
padding:20px;
width:220px;
border-radius:20px;
box-shadow:0 0 20px rgba(0,255,255,0.3);
}

.card p{
font-size:1.5rem;
margin:10px 0;
}

.expired{
color:var(--danger);
font-weight:bold;
font-size:1.4rem;
animation:blink 1s infinite;
}

@keyframes blink{
50%{opacity:0;}
}

.graph-container{
width:85%;
margin:40px auto;
}

button{
padding:10px 20px;
border:none;
border-radius:20px;
cursor:pointer;
margin-top:20px;
background:linear-gradient(90deg,#00f5ff,#00ff99);
color:black;
font-weight:bold;
}

.status{
margin-top:20px;
font-size:0.9rem;
opacity:0.8;
}
</style>
</head>

<body>

<div class="toggle" onclick="toggleMode()">Dark/Light</div>

<h1>VaxSafe AI Monitoring System</h1>

<div class="scene">
<div class="box" id="vaccineBox">
<div class="face front"></div>
<div class="face back"></div>
<div class="face right"></div>
<div class="face left"></div>
<div class="face top"></div>
<div class="face bottom"></div>
</div>
</div>

<div class="dashboard">

<div class="card">
Temperature
<p id="temp">-- °C</p>
</div>

<div class="card">
Potency
<p id="potency">100 %</p>
</div>

<div class="card">
Total Time
<p id="totalTime">00:00:00</p>
</div>

<div class="card">
Unsafe Time
<p id="unsafeTime">00:00:00</p>
</div>

</div>

<div id="expiredMessage"></div>

<div class="graph-container">
<canvas id="chart"></canvas>
</div>

<button onclick="downloadReport()">Download Report</button>

<div class="status">
AI Status: <span id="aiStatus">Stable</span><br>
Blockchain Hash: <span id="hash">Generating...</span>
</div>

<audio id="alertSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>

<script>

const AUTH_TOKEN="e6GmREw4L6j6PHk-Kh621o6MkQoogzqL";
const PIN="V0";

let total=0;
let unsafe=0;
let potency=100;
let expired=false;
let alertPlayed=false;

let temps=[];
let labels=[];

const ctx=document.getElementById("chart").getContext("2d");
const chart=new Chart(ctx,{
type:"line",
data:{labels:labels,datasets:[{label:"Temperature",data:temps,borderWidth:3,tension:0.4}]},
options:{responsive:true,scales:{y:{min:-5,max:30}}}
});

function formatTime(sec){
let h=Math.floor(sec/3600);
let m=Math.floor((sec%3600)/60);
let s=sec%60;
return String(h).padStart(2,"0")+":"+String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

async function fetchTemp(){
if(expired) return;

const r=await fetch(`https://blynk.cloud/external/api/get?token=${AUTH_TOKEN}&${PIN}`);
const temp=parseFloat(await r.text());

document.getElementById("temp").innerText=temp+" °C";

total+=5;

if(temp<-2||temp>8){
unsafe+=5;
potency-=2;
document.getElementById("aiStatus").innerText="CRITICAL";
updateBox(false);
if(!alertPlayed){
document.getElementById("alertSound").play();
alertPlayed=true;
}
}else{
document.getElementById("aiStatus").innerText="Stable";
updateBox(true);
alertPlayed=false;
}

if(potency<=0||unsafe>=300){
expired=true;
document.getElementById("expiredMessage").innerHTML="<div class='expired'>VACCINE EXPIRED</div>";
document.getElementById("aiStatus").innerText="EXPIRED";
updateBox(false);
}

if(potency<0) potency=0;

document.getElementById("potency").innerText=potency+" %";
document.getElementById("totalTime").innerText=formatTime(total);
document.getElementById("unsafeTime").innerText=formatTime(unsafe);

updateGraph(temp);
generateHash(temp);
}

function updateGraph(t){
if(temps.length>20){temps.shift();labels.shift();}
temps.push(t);
labels.push(new Date().toLocaleTimeString());
chart.update();
}

function updateBox(safe){
const faces=document.querySelectorAll(".face");
faces.forEach(f=>{
if(safe){
f.style.background="linear-gradient(145deg,var(--safe),#00ff99)";
f.style.boxShadow="0 0 20px var(--safe)";
}else{
f.style.background="linear-gradient(145deg,var(--danger),#990000)";
f.style.boxShadow="0 0 25px var(--danger)";
}
});
}

async function generateHash(data){
const msg=new TextEncoder().encode(data.toString());
const buffer=await crypto.subtle.digest("SHA-256",msg);
const hashArray=Array.from(new Uint8Array(buffer));
const hashHex=hashArray.map(b=>b.toString(16).padStart(2,"0")).join("");
document.getElementById("hash").innerText=hashHex;
}

function toggleMode(){
document.body.classList.toggle("light");
}

function downloadReport(){
let report=`VaxSafe Monitoring Report\n\nTemperature: ${document.getElementById("temp").innerText}\nPotency: ${potency}%\nTotal Time: ${formatTime(total)}\nUnsafe Time: ${formatTime(unsafe)}\nStatus: ${document.getElementById("aiStatus").innerText}`;
let blob=new Blob([report],{type:"text/plain"});
let link=document.createElement("a");
link.href=URL.createObjectURL(blob);
link.download="VaxSafe_Report.txt";
link.click();
}

setInterval(fetchTemp,5000);
fetchTemp();

</script>

</body>
</html>
